<?xml version="1.0" encoding="utf-8"?>
<s:BorderContainer xmlns:fx="http://ns.adobe.com/mxml/2009"
				   xmlns:s="library://ns.adobe.com/flex/spark"
				   xmlns:mx="library://ns.adobe.com/flex/mx"
				   xmlns:amcharts="http://www.amcharts.com/com_internal"
				   width="100%" height="100%"
				   preinitialize="preinitializeHandler(event)">
	<fx:Declarations>
		<mx:RemoteObject id="MiObjetoRemotoEmpleado" destination="amfphp" fault="errorGeneral(event)"
						 showBusyCursor="true" source="empleado">
			<s:method name="totalDeVentasPorEmpleado" result="totalDeVentasPorEmpleadoExito(event)"/>
		</mx:RemoteObject>
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			import com.adobe.serialization.json.JSON;
			
			import flash.filters.DropShadowFilter;
			
			import mx.collections.ArrayCollection;
			import mx.events.FlexEvent;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			
			[Bindable] internal var shadow:DropShadowFilter = new DropShadowFilter(2,45,0,0.5);
			
			internal function preinitializeHandler(event:FlexEvent):void
			{
				MiObjetoRemotoEmpleado.totalDeVentasPorEmpleado.send();
			}
			
			internal function errorGeneral(error:FaultEvent):void
			{
				trace(error.fault.faultString);
			}
			
			internal function totalDeVentasPorEmpleadoExito(event:ResultEvent):void {
				removeEventListener(ResultEvent.RESULT, totalDeVentasPorEmpleadoExito);
				encapsulado((com.adobe.serialization.json.JSON.decode(String(event.result))));	
			}
			
			[Bindable] internal var dp:ArrayCollection = new ArrayCollection();
			
			internal function encapsulado(collection:*):void{
				for each(var item:Object in collection){
					dp.addItem({
						nombre:item.nombre,
						Ventas_Totales:uint(item.Ventas_Totales),
						Total_Vendido:Number(item.Total_Vendido)
					});
				}
			}
			
		]]>
	</fx:Script>
	<amcharts:AmPieChart width="100%" height="100%" angle="5"
						 balloonText="[[nombre]] a hecho [[Ventas_Totales]] ventas por un total de [[Total_Vendido]] pesos."
						 dataProvider="{dp}" depth3D="5" filters="{[shadow]}" gradient="radial"
						 groupPercent="3" innerRadius="10" labelWidth="100" marginLeft="0"
						 marginRight="0" startDuration="3" startRadius="600" styleName="MyTextStyle"
						 titleField="nombre" valueField="Total_Vendido">
		
		<amcharts:balloon>	
			<amcharts:AmBalloon borderAlpha="1" borderColor="#FFFFFF" borderThickness="2"
								cornerRadius="10"/>                
		</amcharts:balloon>
		
	</amcharts:AmPieChart>
</s:BorderContainer>
